{% extends 'index.html' %}
{% load static %}

{% block title %}Resultados de la búsqueda{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'Gpoint/styles/search.css' %}">
{% endblock %}

{% block content %}
  <!-- Barra SIEMPRE visible en resultados -->
  <div class="search-wrapper">
    <form class="search-bar" action="/search/productos/" method="get">
      <input
        type="text"
        name="busqueda"
        value="{{ query|default_if_none:'' }}"
        placeholder="Buscar..."
        autocomplete="off"
        required
      >
      <button type="submit">Buscar</button>
    </form>
  </div>

  <section class="contenedor" id="section_productos">
    <h1 class="titulo" id="search-title">Resultados de la búsqueda</h1>

    <div class="contenedor" id="contenedor_productos">
      {% if productos and productos|length %}
        <div class="grid">
          {% for producto in productos %}
            <article class="card">
              {% if producto.imagen_url %}
                {% if producto.permalink %}
                  <a href="{{ producto.permalink }}" target="_blank" rel="noopener">
                    <img src="{{ producto.imagen_url }}" alt="{{ producto.nombre }}"
                        style="width:100%; height:150px; object-fit:cover; border-radius:.5rem;">
                  </a>
                {% else %}
                  <img src="{{ producto.imagen_url }}" alt="{{ producto.nombre }}"
                      style="width:100%; height:150px; object-fit:cover; border-radius:.5rem;">
                {% endif %}
              {% endif %}

              <h3 style="margin:.4rem 0; font-size:16px;">
                {% if producto.permalink %}
                  <a href="{{ producto.permalink }}" target="_blank" rel="noopener">{{ producto.nombre }}</a>
                {% else %}
                  {{ producto.nombre }}
                {% endif %}
              </h3>

              {% if producto.precio %}
                <p style="font-weight:600;">$ {{ producto.precio }}</p>
              {% endif %}
            </article>
          {% endfor %}
        </div>
      {% else %}
        <div class="empty">No se encontraron productos que coincidan con tu búsqueda.</div>
      {% endif %}
    </div>
  </section>
{% endblock %}


